<!DOCTYPE HTML PUBLIC "-//W3O//DTD W3 HTML 2.0//EN">
<!-- This collection of hypertext pages is Copyright 1995-2005 by Steve Summit. -->
<!-- Content from the book "C Programming FAQs: Frequently Asked Questions" -->
<!-- (Addison-Wesley, 1995, ISBN 0-201-84519-9) is made available here by -->
<!-- permission of the author and the publisher as a service to the community. -->
<!-- It is intended to complement the use of the published text -->
<!-- and is protected by international copyright laws. -->
<!-- The on-line content may be accessed freely for personal use -->
<!-- but may not be published or retransmitted without explicit permission. -->
<!-- -->
<!-- this page built Sat Dec 24 21:47:47 2005 by faqproc version 2.7 -->
<!-- from source file osdepfile.sgml dated Sat Jun 26 20:52:13 2004 -->
<!-- corresponding to FAQ list version 4.0 -->
<html>
<head>
<meta name=GENERATOR content="faqproc">
<title>Question 19.12</title>
<link href="fileexists.html" rev=precedes>
<link href="modtime.html" rel=precedes>
<link href="index.html" rev=subdocument>
</head>
<body bgcolor="#ffffff">
<a href="fileexists.html" rev=precedes><img src="../images/buttonleft.gif" alt="prev"></a>
<a href="index.html" rev=subdocument><img src="../images/buttonup.gif" alt="up"></a>
<a href="modtime.html" rel=precedes><img src="../images/buttonright.gif" alt="next"></a>
&nbsp;
<a href="../index.html"><img src="../images/buttontop.gif" alt="top/contents"></a>
<a href="../search.html"><img src="../images/buttonsrch.gif" alt="search"></a>
<hr>
<p><!-- qbegin -->
<h1>
comp.lang.c FAQ list
<font color=blue>&middot;</font>
<!-- qtag -->Question 19.12
</h1>
<p>
<font face=Helvetica size=8 color=blue><b>Q:</b></font>
How can I find out the size of a file,
prior to reading it in?
</p><p><hr>
<p>
<font face=Helvetica size=8 color=blue><b>A:</b></font>

If the ``size of a file''
is the number of characters you'll be able to read from it
in C
(or which were written to it by a previous program),
it
can be
difficult
or
impossible
to determine this number
exactly



(other than
by reading the whole file).
</p><p>Under
Unix,
the <TT>stat</TT> call
(specifically,
the <TT>st_size</TT> field of the stat structure)
will give you an exact answer.
<a href="concur2.html" rel=subdocument>[footnote]</a>
Several other systems supply a
Unix-like
<TT>stat</TT>
call,
but the sizes reported for text files
may be approximate
(due to differing end-of-line representations;
see question <a href="../stdio/textvsbinary.html">12.40</a>).
You can
open the file and use <TT>fstat</TT>,
or
<TT>fseek</TT> to the end
of the file
and then use <TT>ftell</TT>,
but

these tend to have
the same
problems:
<TT>fstat</TT> is not portable,
and generally tells you the same thing <TT>stat</TT> tells you;
<TT>ftell</TT> is not guaranteed to return a byte count
except for binary files









(but,
strictly speaking,
binary files don't necessarily support <TT>fseek</TT> to <TT>SEEK_END</TT>
at all).



Some systems
provide functions called
<TT>filesize</TT>
or <TT>filelength</TT>,
but these are obviously not portable, either.
</p><p>Are you sure you have to determine the file's size in advance?
Since the most accurate way of determining the size of a file as
a C program will see it is to
open the file
and read it,
perhaps you can rearrange the code to learn the size as it reads.
(In general, your program
should behave
gracefully
if
the
number of characters
actually
read
does not
match
prior expectations,
since any advance determination of the size might be approximate.)
See also questions
<a href="../malloc/realloc.html">7.29</a>,
<a href="../malloc/reallocnull.html">7.30</a>,
and <a href="../misc/ragged.html">20.2</a>.
</p><p>Additional links:
<a href="sd23.html" rel=subdocument>further reading</a>
</p>



<p>References:

ISO Sec. 7.9.9.4
<br>
H&amp;S Sec. 15.5.1
<br>
PCS Sec. 12 p. 213
<br>
POSIX Sec. 5.6.2
<br></p><!-- aend -->
<p>
<hr>
<a href="fileexists.html" rev=precedes><img src="../images/buttonleft.gif" alt="prev"></a>
<a href="index.html" rev=subdocument><img src="../images/buttonup.gif" alt="up"></a>
<a href="modtime.html" rel=precedes><img src="../images/buttonright.gif" alt="next"></a>
&nbsp;
<a href="../questions.html"><img src="../images/buttontop.gif" alt="contents"></a>
<a href="../search.html"><img src="../images/buttonsrch.gif" alt="search"></a>
<br><!-- lastfooter -->
<a href="../about.html">about this FAQ list</a>
&nbsp;
<a href="../eskimo.html">about eskimo</a>
&nbsp;
<a href="../search.html">search</a>
&nbsp;
<a href="../feedback.html">feedback</a>
&nbsp;
<a href="copyright.html">copyright</a>
<p>
Hosted by
<a href="http://www.eskimo.com/"><img src="http://www.eskimo.com/img/link/eskitiny.gif" alt="Eskimo North"></a>
</body>
</html>
